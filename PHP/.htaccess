# ================================
# PHP API Security
# ================================

<IfModule mod_rewrite.c>
    RewriteEngine On

    # --------------------------------
    # Explizit erlaubte Endpunkte
    # --------------------------------

    # CSRF-Token abrufen (GET)
    RewriteRule ^csrf\.php$ - [L]

    # send.php nur per POST
    RewriteCond %{REQUEST_METHOD} POST
    RewriteRule ^send_kontakt\.php$ - [L]
    RewriteRule ^send_sepa\.php$ - [L]

    # --------------------------------
    # Alles andere blockieren
    # --------------------------------

    # Alle anderen PHP-Dateien verbieten
    RewriteRule \.php$ - [F,L]

    # Sensible Dateien blockieren
    RewriteRule \.(inc|conf|ini|log|sh|sql)$ - [F,L]
</IfModule>

# Verzeichnis-Listing aus
Options -Indexes
